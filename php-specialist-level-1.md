### Переменные

#### Области видимости переменных

Существуют две области **переменных**:

* Глобальная
* Локальная

**Глобальная** область - это всё что находиться вне функции.

К **локальным** относятся те переменные, которые находятся внутри функции + её аргументы.

Три способа пользоваться глобальной переменной находясь в функции:

1. Объявить переменную с помощью ключевого слова **global**

   ```php
   global $name;
   ```

   Таким способом создаётся не переменная а ссылка на неё.  
   Лучше перечислять такие переменные в начале функции.

2. Все глобальные переменные доступны через суперглобальный массив **$GLOBALS**

   ```php
   $GLOBALS["name"];
   ```

3. Установить амперсанд \(&\) перед переменной в параметре функции.

   ```php
   function sayHallo(&$name)
   ```

   В функцию передаётся не копия переменной а **ссылка**.

Не рекомендуется изменять глобальные переменные из функции.

Для сохранения **локальной** переменной \(объявленной в функции\) после отработки функции, можно использовать ключевое слово **static**:

```php
function sayHello() {
    static $val = 1;
}
```

---

### Функции

**Если что-то в коде повторяется - нужно писать функцию!**

#### Уточнение типа

Для проверки передачи массива в функцию

```php
function foo(array $var) {} // Ожидается только массив
```

С PHP 5.4 можно указать уточнение **callable**

```php
function bar(callable $var, $arg) {
    return $var($arg);
}
```

С PHP 7 можно уточнять скалярные типы

```php
function foo(int $i, string $s, bool $b, int ...$nums):bool {}

// int ...$nums - означает что все последующие переменные должны быть типом int
// :bool - тип возвращаемого функцией значения.
```

Выявить ошибку в такой функции можно только запустив её. При этом если PHP может выполнить автоприведение типов, ошибка не появиться.

> Например: строка "5" приведётся к числу 5, если будет уточнение по int.

Для включения строгой типизации необходио самой первой строкой указать:

```php
declare(strict_types=1);
```

---

### Языковые конструкции

* die и exit
* echo и print

  print - всегда возвращает 1.

  echo - единственная конструкция, которая ничего не возващает.

* isset и unset

* include и include\_once

* require и require\_once

* empty

* eval
* list
* return

---

### Константы и псевдоконстанты

Псевдоконстанты:

* `__LINE__` - возвращает номер строки в которой она прописана;
* `__FILE__` - возвращает полный физический путь к файлу;
* `__FUNCTION__` - прописанная в функции, вернёт имя этой функции;
* `__DIR__` - возвращает полный физический путь к директории;

---

### Include / Require

`include` - в случае невозможности подключения файла выдаёт `Warning` и продолжает выполнение скрипта.

`require` - в случае невозможности подключения файла выдаёт `Fatal error` и завершает работу скрипта.

`..._once` - говорит php что файл может быть подключен только один раз.

---

### Методы передачи информации на сервер \(GET, POST\):

Недостатки GET:

* Может быть много символов в адресной строке
* Передаваемые данные логгируются на сервере, тем самым не безопасно передавай конфиденциальную информацию
* Есть то что данный запрос технически не может выполнить. _Например: невозможно закачать файл._

При запросе методом POST данные передаются не в адресной строке, а в теле запроса.

Никогда нельзя обращаться напрямую к переменным `$_GET`, `$_POST`. Их нужно проверять и фильтровать.

_Пример:_

```php
$name = trim(strip_tags($_POST['name']));
$age = abs((int) $_POST['age']);
```

`strip_tags();` - удаляет всё что находится в тегах.

`trim();` - удаляет пробелы справа и слева.

`(int)` - преобразует значение к целому числу.

